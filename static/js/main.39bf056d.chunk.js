(this["webpackJsonpsocial-network"]=this["webpackJsonpsocial-network"]||[]).push([[0],{123:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return m}));var a=n(8),r=n(16),o={isLoading:!1,profileInfo:null,status:""};function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_PROFILE":return Object(a.a)({},e,{profileInfo:Object(a.a)({},t.profile)});case"TOGGLE_IS_LOADING":return Object(a.a)({},e,{isLoading:t.loading});case"SET_STATUS":return Object(a.a)({},e,{status:t.status});default:return e}}var i=function(e){return{type:"TOGGLE_IS_LOADING",loading:e}},c=function(e){return{type:"SET_STATUS",status:e}},u=function(e){return function(t){t(i(!1)),r.b.getProfile(e).then((function(e){t({type:"SET_PROFILE",profile:e}),t(i(!0))}))}},l=function(e){return function(t){r.b.getStatus(e).then((function(e){t(c(e))}))}},m=function(e){return function(t){r.b.updateStatus(e).then((function(n){n.resultCode||t(c(e))}))}}},131:function(e,t,n){e.exports={Messages:"Messages_Messages__33Ht9"}},132:function(e,t,n){e.exports={News:"News_News__30ej5"}},133:function(e,t,n){e.exports={Settings:"Settings_Settings__2NZt4"}},16:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return i}));var a=n(130),r=n.n(a).a.create({withCredentials:!0,baseURL:"https://social-network.samuraijs.com/api/1.0/",headers:{"API-KEY":"1d50145e-9b5b-43e8-933a-f2213da6e70b"}}),o={getUsers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return r.get("users?page=".concat(e,"&count=").concat(t)).then((function(e){return e.data}))},follow:function(e){return r.post("follow/".concat(e)).then((function(e){return e.data}))},unfollow:function(e){return r.delete("follow/".concat(e)).then((function(e){return e.data}))}},s={getProfile:function(e){return r.get("profile/".concat(e)).then((function(e){return e.data}))},getStatus:function(e){return r.get("profile/status/".concat(e)).then((function(e){return e.data}))},updateStatus:function(e){return r.put("profile/status",{status:e}).then((function(e){return e.data}))}},i={me:function(){return r.get("auth/me").then((function(e){return e.data}))},login:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r.post("auth/login",{email:e,password:t,rememberMe:n}).then((function(e){return e.data}))},logout:function(){return r.delete("auth/login").then((function(e){return e.data}))}}},161:function(e,t,n){e.exports=n(287)},166:function(e,t,n){},167:function(e,t,n){},287:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(60),s=n.n(o),i=(n(166),n(24)),c=n(25),u=n(27),l=n(26),m=n(28),f=(n(167),n(85)),d=n.n(f),p=n(9),h=n(12),g=n(7),E=n(66),b=n.n(E),_=function(e){return r.a.createElement("div",{onClick:function(){return e.onClickUserItem(e.userId)},className:b.a.UserListItem},r.a.createElement("div",{className:b.a.UserListItemImg},r.a.createElement("img",{src:e.photo?e.photo:"https://specenergo.ru/sites/default/files/styles/mt_testimonial_image/public/2016-11/testimonial-4.jpg?itok=a7UblV6p",alt:"img"})),r.a.createElement("div",{className:b.a.UserListItemName},e.name),e.followed?r.a.createElement("button",{disabled:e.followingInProgress.some((function(t){return t===e.userId})),onClick:function(t){t.stopPropagation(),e.unfollow(e.userId)}},"Unfollow"):r.a.createElement("button",{disabled:e.followingInProgress.some((function(t){return t===e.userId})),onClick:function(t){t.stopPropagation(),e.follow(e.userId)}},"Follow"))},v=n(47),O=n(126),I=n(43),S=n.n(I),N=function(e){for(var t=Math.ceil(e.totalUsersCount/e.pageSize),n=[],o=1;o<=t;o++)n.push(o);var s=Math.ceil(t/e.portionSize),i=Object(a.useState)(1),c=Object(O.a)(i,2),u=c[0],l=c[1],m=(u-1)*e.portionSize+1,f=u*e.portionSize;return r.a.createElement("div",{className:S.a.Pagination},u>1&&r.a.createElement("button",{className:S.a.PaginationControl,onClick:function(){l(u-1)}},"Prev"),r.a.createElement("div",{className:S.a.PaginationItems},n.filter((function(e){return e>=m&&e<=f})).map((function(t){return r.a.createElement("span",{className:e.currentPage===t?S.a.active:"",key:t,onClick:function(){return e.onPageChanged(t,e.pageSize)}},t)}))),s>u&&r.a.createElement("button",{className:S.a.PaginationControl,onClick:function(){l(u+1)}},"Next"))},L=function(e){return{isAuth:e.authReducer.isAuth}},C=n(91),k=n(8),w=n(16),j={users:[],pageSize:10,portionSize:10,totalUsersCount:0,currentPage:1,isLoaded:!1,followingInProgress:[]};var U=function(e,t){return{type:"TOGGLE_IS_FOLLOWING_PROGRESS",isFetching:e,userId:t}},T=function(e){return{type:"TOGGLE_IS_LOADED",isLoaded:e}},P=function(e){return{type:"SET_USERS",users:e}},y=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).hundlerClickUserItem=function(e){n.props.history.push("/profile/".concat(e))},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.getUsersThunkCreator()}},{key:"render",value:function(){var e=this,t=r.a.createElement("div",{className:d.a.UsersLoading},r.a.createElement(v.a,null)),n=r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:d.a.Users},this.props.users.map((function(t){return r.a.createElement(_,{name:t.name,userId:t.id,photo:t.photos.large,key:t.id,followed:t.followed,follow:e.props.follow,unfollow:e.props.unfollow,onClickUserItem:e.hundlerClickUserItem,followingInProgress:e.props.followingInProgress})}))),r.a.createElement(N,{totalUsersCount:this.props.totalUsersCount,pageSize:this.props.pageSize,portionSize:this.props.portionSize,currentPage:this.props.currentPage,onPageChanged:this.props.onPageChanged}));return this.props.isLoaded?n:t}}]),t}(a.Component),x=Object(g.d)(Object(p.b)((function(e){return{users:e.usersReducer.users,pageSize:e.usersReducer.pageSize,portionSize:e.usersReducer.portionSize,totalUsersCount:e.usersReducer.totalUsersCount,currentPage:e.usersReducer.currentPage,isLoaded:e.usersReducer.isLoaded,followingInProgress:e.usersReducer.followingInProgress}}),{getUsersThunkCreator:function(){return function(e){e(T(!1)),w.c.getUsers().then((function(t){e(P(t.items)),e({type:"SET_USERS_TOTAL_COUNT",usersTotalCount:t.totalCount}),e(T(!0))}))}},onPageChanged:function(e,t){return function(n){n(function(e){return{type:"SET_CURRENT_PAGE",currentPage:e}}(e)),w.c.getUsers(e,t).then((function(e){n(P(e.items))}))}},follow:function(e){return function(t){t(U(!0,e)),w.c.follow(e).then((function(n){0===n.resultCode&&t(function(e){return{type:"FOLLOW",userId:e}}(e)),t(U(!1,e))}))}},unfollow:function(e){return function(t){t(U(!0,e)),w.c.unfollow(e).then((function(n){0===n.resultCode&&t(function(e){return{type:"UNFOLLOW",userId:e}}(e)),t(U(!1,e))}))}}}),h.g,(function(e){var t=function(t){function n(){return Object(i.a)(this,n),Object(u.a)(this,Object(l.a)(n).apply(this,arguments))}return Object(m.a)(n,t),Object(c.a)(n,[{key:"render",value:function(){return this.props.isAuth?r.a.createElement(e,this.props):r.a.createElement(h.a,{to:"/login"})}}]),n}(r.a.Component);return Object(p.b)(L)(t)}))(y),A=n(131),R=n.n(A),F=function(){return r.a.createElement("div",{className:R.a.Messages},"There will be messages")},z=n(132),G=n.n(z),D=function(){return r.a.createElement("div",{className:G.a.News},"There will be news")},M=n(133),W=n.n(M),H=function(){return r.a.createElement("div",{className:W.a.Settings},"There will be Settings")},B=n(36),J=n.n(B),q=n(124),K=n(125),Y=n(37),Z=n.n(Y),V=n(67),Q=n(61),X={id:null,email:null,login:null,isAuth:!1};var $=function(e,t,n,a){return{type:"auth/SET_AUTH_USER_DATA",data:{userId:e,email:t,login:n,isAuth:a}}},ee=function(){return function(){var e=Object(V.a)(Z.a.mark((function e(t){var n,a,r,o,s;return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.me();case 2:0===(n=e.sent).resultCode&&(a=n.data,r=a.id,o=a.email,s=a.login,t($(r,o,s,!0)));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},te=function(){return function(){var e=Object(V.a)(Z.a.mark((function e(t){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.logout();case 2:0===e.sent.resultCode&&t($(null,null,null,!1));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},ne=n(92),ae=n(88),re=n.n(ae),oe=function(e){var t=e.input,n=e.meta,a=Object(ne.a)(e,["input","meta"]);return r.a.createElement("div",{className:re.a.FormInput},r.a.createElement("input",Object.assign({},t,a)),n.touched&&n.error&&r.a.createElement("div",{style:{color:"red",marginTop:"10px"}},n.error))},se=function(e){var t=e.input,n=(e.meta,Object(ne.a)(e,["input","meta"]));return r.a.createElement("div",{className:re.a.FormCheckbox},r.a.createElement("label",{htmlFor:""},r.a.createElement("input",Object.assign({},t,n))))},ie=function(e){if(!e)return"Field is required";console.log("validate(required) ok")},ce=Object(K.a)({form:"login"})((function(e){return r.a.createElement("form",{className:J.a.Form,onSubmit:e.handleSubmit},r.a.createElement("div",{className:J.a.FormItem},r.a.createElement("label",{htmlFor:""},"Login"),r.a.createElement(q.a,{validate:[ie],name:"email",component:oe,placeholder:"Email"})),r.a.createElement("div",{className:J.a.FormItem},r.a.createElement("label",{htmlFor:""},"Password"),r.a.createElement(q.a,{name:"password",component:oe,placeholder:"Password"})),r.a.createElement("div",{className:J.a.FormItemCheckbox},r.a.createElement(q.a,{name:"rememberMe",id:"checkbox",type:"checkbox",component:se}),r.a.createElement("label",{htmlFor:"checkbox"},"Remember")),e.error&&r.a.createElement("div",{style:{color:"red"}},e.error),r.a.createElement("div",{className:J.a.FormItemButton},r.a.createElement("button",null,"Login")))})),ue=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).onSubmit=function(e){n.props.loginThunk(e.email,e.password,e.rememberMe)},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:J.a.Login},r.a.createElement(ce,{onSubmit:this.onSubmit}))}}]),t}(a.Component),le=Object(p.b)((function(e){return{isAuth:e.authReducer.isAuth}}),{loginThunk:function(e,t,n){return function(){var a=Object(V.a)(Z.a.mark((function a(r){var o,s,i;return Z.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,w.a.login(e,t,n);case 2:0===(o=a.sent).resultCode?r(ee()):(s=o.messages.length>0?o.messages[0]:"Some Error",i=Object(Q.a)("login",{_error:s}),r(i));case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},logoutThunk:te})(ue),me=n(32),fe=n.n(me),de=n(20),pe=Object(p.b)((function(e){return{userId:e.authReducer.id}}))((function(e){return r.a.createElement("nav",{className:fe.a.Nav},r.a.createElement("ul",{className:fe.a.NavList},r.a.createElement("li",null,r.a.createElement(de.b,{to:"/profile/6426",activeClassName:fe.a.active,exact:!0},"My profile")),r.a.createElement("li",null,r.a.createElement(de.b,{to:"/",activeClassName:fe.a.active,exact:!0},"Users")),r.a.createElement("li",null,r.a.createElement(de.b,{to:"/messages",activeClassName:fe.a.active},"Messages")),r.a.createElement("li",null,r.a.createElement(de.b,{to:"/news",activeClassName:fe.a.active,exact:!0},"News")),r.a.createElement("li",null,r.a.createElement(de.b,{to:"/settings",activeClassName:fe.a.active},"Settings"))))})),he={initialized:!1};var ge=function(e){return e.authReducer.isAuth},Ee=function(e){return e.authReducer.login},be=r.a.lazy((function(){return n.e(3).then(n.bind(null,290))})),_e=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.initializeThunk()}},{key:"render",value:function(){var e=this;return this.props.initialized?r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"Header"},r.a.createElement("div",{className:"Logo"},"SocialNetwork"),r.a.createElement("div",{className:"User"},!this.props.isAuth&&r.a.createElement("div",{style:{marginLeft:"20px",cursor:"pointer"}},r.a.createElement(de.b,{to:"/login"},"Login")),this.props.isAuth&&r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"UserName"},this.props.login),r.a.createElement("div",{className:"Avatar"},r.a.createElement("img",{src:"https://specenergo.ru/sites/default/files/styles/mt_testimonial_image/public/2016-11/testimonial-4.jpg?itok=a7UblV6p",alt:"Avatar"})),r.a.createElement("span",{style:{marginLeft:"20px",cursor:"pointer"},onClick:function(){return e.props.logoutThunk()}},"Logout")))),r.a.createElement("div",{className:"Content"},r.a.createElement(pe,null),r.a.createElement("main",{className:"MainContent"},r.a.createElement(h.d,null,r.a.createElement(h.b,{path:"/",exact:!0},r.a.createElement(x,null)),r.a.createElement(h.b,{path:"/profile/:userId"},r.a.createElement(a.Suspense,{fallback:r.a.createElement("div",null,r.a.createElement(v.a,null))},r.a.createElement(be,null))),r.a.createElement(h.b,{path:"/Login",exact:!0},r.a.createElement(le,null)),r.a.createElement(h.b,{path:"/messages",exact:!0},r.a.createElement(F,null)),r.a.createElement(h.b,{path:"/news",exact:!0},r.a.createElement(D,null)),r.a.createElement(h.b,{path:"/settings",exact:!0},r.a.createElement(H,null)))))):r.a.createElement("div",{style:{backgroundColor:"green",width:"100%",height:"100%"}},r.a.createElement(v.a,null))}}]),t}(a.Component),ve=Object(g.d)(h.g,Object(p.b)((function(e){return{isAuth:ge(e),login:Ee(e),initialized:e.appReducer.initialized}}),{logoutThunk:te,initializeThunk:function(){return function(e){var t=e(ee());Promise.all([t]).then((function(){e({type:"SET_INITIALIZED"})}))}}}))(_e),Oe=n(123),Ie=n(127),Se=Object(g.c)({appReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_INITIALIZED":return Object(k.a)({},e,{initialized:!0});default:return e}},authReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"auth/SET_AUTH_USER_DATA":return Object(k.a)({},e,{},t.data,{isAuth:t.data.isAuth});default:return e}},usersReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USERS":return Object(k.a)({},e,{users:Object(C.a)(t.users)});case"SET_USERS_TOTAL_COUNT":return Object(k.a)({},e,{totalUsersCount:t.usersTotalCount});case"SET_CURRENT_PAGE":return Object(k.a)({},e,{currentPage:t.currentPage});case"FOLLOW":return Object(k.a)({},e,{users:e.users.map((function(e){return e.id===t.userId?Object(k.a)({},e,{followed:!0}):e}))});case"UNFOLLOW":return Object(k.a)({},e,{users:e.users.map((function(e){return e.id===t.userId?Object(k.a)({},e,{followed:!1}):e}))});case"TOGGLE_IS_LOADED":return Object(k.a)({},e,{isLoaded:t.isLoaded});case"TOGGLE_IS_FOLLOWING_PROGRESS":return Object(k.a)({},e,{followingInProgress:t.isFetching?[].concat(Object(C.a)(e.followingInProgress),[t.userId]):e.followingInProgress.filter((function(e){return e!==t.userId}))});default:return e}},profileReducer:Oe.a,form:Ie.a}),Ne=n(135),Le=Object(g.e)(Se,Object(g.a)(Ne.a));window.store=Le;var Ce=r.a.createElement(p.a,{store:Le},r.a.createElement(de.a,null,r.a.createElement(ve,null)));s.a.render(Ce,document.getElementById("root"))},31:function(e,t,n){e.exports={skChase:"Spinner_skChase__U0TiR","sk-chase":"Spinner_sk-chase__3HvUI",skChaseDot:"Spinner_skChaseDot__1zdue","sk-chase-dot":"Spinner_sk-chase-dot__3b1L5","sk-chase-dot-before":"Spinner_sk-chase-dot-before__3exAG"}},32:function(e,t,n){e.exports={Nav:"Nav_Nav__bCTYE",NavList:"Nav_NavList__KuCu7",active:"Nav_active__11_gR"}},36:function(e,t,n){e.exports={Login:"Login_Login__1t_6N",Form:"Login_Form__2-G2S",FormItem:"Login_FormItem__1EkK2",FormItemCheckbox:"Login_FormItemCheckbox__30jr_",FormItemButton:"Login_FormItemButton__3iJ53"}},43:function(e,t,n){e.exports={Pagination:"Pagination_Pagination__2rvuc",PaginationControl:"Pagination_PaginationControl__2F2eL",PaginationItems:"Pagination_PaginationItems__3Rh8D",active:"Pagination_active__28ytu"}},47:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(31),s=n.n(o);t.a=function(){return r.a.createElement("div",{className:s.a.skChase},r.a.createElement("div",{className:s.a.skChaseDot}),r.a.createElement("div",{className:s.a.skChaseDot}),r.a.createElement("div",{className:s.a.skChaseDot}),r.a.createElement("div",{className:s.a.skChaseDot}),r.a.createElement("div",{className:s.a.skChaseDot}),r.a.createElement("div",{className:s.a.skChaseDot}))}},66:function(e,t,n){e.exports={UserListItem:"UserListItem_UserListItem__Sz2rs",UserListItemImg:"UserListItem_UserListItemImg__1emSv",UserListItemName:"UserListItem_UserListItemName__3yikv"}},85:function(e,t,n){e.exports={Users:"UsersList_Users__2YTJ6",UsersLoading:"UsersList_UsersLoading__Gqu-s"}},88:function(e,t,n){e.exports={FormCheckbox:"FormControl_FormCheckbox__28GhW"}}},[[161,1,2]]]);
//# sourceMappingURL=main.39bf056d.chunk.js.map